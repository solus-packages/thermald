name       : thermald
version    : 1.7.1
release    : 5
source     :
    - https://github.com/intel/thermal_daemon/archive/v1.7.1.tar.gz : c4465d9312304b879908289e2e9da7417e88151c1529dff42acb8e3fb6aa4f47
license    : GPL-2.0
component  : system.utils
summary    : Thermal daemon for IA
description: |
    Thermal daemon for IA
builddeps  :
    - pkgconfig(dbus-1)
    - pkgconfig(dbus-glib-1)
    - pkgconfig(gio-unix-2.0)
    - pkgconfig(libxml-2.0)
setup      : |
    %patch -p1 < $pkgfiles/0001-Do-not-start-on-virtualized-environments.patch
    %autogen
build      : |
    %make
install    : |
    %make_install

    # We use systemd.
    rm -rf $installdir/etc/init

    # Users may systemctl mask to turn it off.
    install -d -D -m 00755 $installdir/%libdir%/systemd/system/multi-user.target.wants
    ln -sv thermald.service $installdir/%libdir%/systemd/system/dbus-org.freedesktop.thermald.service
    ln -sv ../thermald.service $installdir/%libdir%/systemd/system/multi-user.target.wants
